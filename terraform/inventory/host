---
webservers:
  hosts:
    machine1.meinit.nl:
  vars:
    postfix_relayhost: "[machine4.meinit.nl]"
    httpd_applications:
      - name: zabbix
        location: /zabbix
        backend_url: "https://{{ hostvars['machine4.meinit.nl']['inventory_hostname'] }}:8080/zabbix"
      - name: roundcubemail
        location: /roundcubemail
        backend_url: "https://{{ hostvars['machine4.meinit.nl']['inventory_hostname'] }}/roundcubemail"
      - name: rundeck
        location: /rundeck
        backend_url: "https://{{ hostvars['machine4.meinit.nl']['inventory_hostname'] }}/rundeck"

applicationservers:
  hosts:
    machine2.meinit.nl:
  vars:
    postfix_relayhost: "[machine4.meinit.nl]"

databaseservers:
  hosts:
    machine3.meinit.nl:
  vars:
    postfix_relayhost: "[machine4.meinit.nl]"
    mysql_databases:
      - name: zabbix
      - name: roundcube
    mysql_users:
      - name: zabbix
        password: zabbix
        priv: "*.*:ALL"
        host: "{{ hostvars['machine1.meinit.nl']['ansible_default_ipv4']['address'] }}"
      - name: roundcube
        password: roundcube
        priv: "*.*:ALL"
        host: "{{ hostvars['machine1.meinit.nl']['ansible_default_ipv4']['address'] }}"

backendservers:
  hosts:
    machine4.meinit.nl:
  vars:
    postfix_mydestination: "meinit.nl, $mydomain, $myhostname, localhost.$mydomain, localhost"
    dns_zones:
      - name: example.com
        ttl: 3600
        ns:
          - name: dns1.example.com.
        mx:
          - name: mail1.example.com.
            priority: 10
        records:
          - name: www
            ttl: 60
            value: "{{ hostvars['machine1.meinit.nl']['ansible_default_ipv4']['address'] }}"
          - name: dns1
            value: "{{ hostvars['machine4.meinit.nl']['ansible_default_ipv4']['address'] }}"
          - name: mail1
            value: "{{ hostvars['machine4.meinit.nl']['ansible_default_ipv4']['address'] }}"
    roundcubemail_database_url: "mysql://roundcube:roundcube@{{ hostvars['machine3.meinit.nl']['inventory_hostname'] }}/roundcube"

all:
  vars:
    ansible_user: root
    linux_users:
      - name: robertdb
        comment: Robert de Bock
        password: "$6$FHM5RfKd33/xKoUo$Io/VK01U7BXLE6HISycXevQiFYrWAGVV9i68roeo.iCeAJ64uRsTExhRYwrYW12bDQK1Pl3FGaMJ6i/QZDkEl1"
